const int KEY_LEN = 256;

forall X -> X tuple_index(tuple t, int index) asm "INDEXVAR";

(tuple) util_addresses() {
    tuple result = empty_tuple();
    result = result.tpush("Ef8RERERERERERERERERERERERERERERERERERERERERERlb"a);
    result = result.tpush("Ef8iIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiImKK"a);
    result = result.tpush("Ef8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM0vF"a);
    result = result.tpush("Ef9ERERERERERERERERERERERERERERERERERERERERERJUo"a);
    result = result.tpush("Ef9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVbxn"a);

    return result;
}

_ __test_participate() {
    tuple addresses = util_addresses();
    var (_, _) = invoke_method(participate, [addresses.tuple_index(0), 15, 0]);

    slice storage_sl = get_data().begin_parse();
    cell addr2stake = storage_sl~load_ref();
    cell stake2info = storage_sl~load_ref();
    (slice actual_stake_sl, int success) = addr2stake.udict_get?(KEY_LEN, addresses.tuple_index(0).slice_hash());
    throw_if(100, ~ success);
    int actual_stake = actual_stake_sl~load_uint(16);
    throw_if(101, actual_stake != 15);
}
